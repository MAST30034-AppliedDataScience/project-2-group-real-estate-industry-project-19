import pandas as pd
import re
from dateutil import parser
from datetime import datetime
suburb_postcode_mapping = {
    'melbourne': '3004',
 'east melbourne': '3002',
 'west melbourne': '3003',
 'south wharf': '3006',
 'southbank': '3006',
 'docklands': '3008',
 'university of melbourne': '3010',
 'footscray': '3011',
 'seddon': '3011',
 'seddon west': '3011',
 'brooklyn': '3012',
 'kingsville': '3012',
 'maidstone': '3012',
 'tottenham': '3012',
 'west footscray': '3012',
 'yarraville': '3013',
 'newport': '3015',
 'south kingsville': '3015',
 'spotswood': '3015',
 'williamstown': '3016',
 'williamstown north': '3016',
 'altona': '3018',
 'seaholme': '3018',
 'braybrook': '3019',
 'robinson': '3019',
 'albion': '3020',
 'sunshine': '3020',
 'sunshine north': '3020',
 'sunshine west': '3020',
 'albanvale': '3021',
 'kealba': '3021',
 'kings park': '3021',
 'st albans': '3021',
 'ardeer': '3022',
 'deer park east': '3022',
 'burnside': '3023',
 'burnside heights': '3023',
 'cairnlea': '3023',
 'caroline springs': '3023',
 'deer park': '3023',
 'deer park north': '3023',
 'ravenhall': '3023',
 'mambourin': '3024',
 'mount cottrell': '3024',
 'wyndham vale': '3024',
 'altona east': '3025',
 'altona gate': '3025',
 'altona north': '3025',
 'laverton north': '3026',
 'williams landing': '3027',
 'altona meadows': '3028',
 'laverton': '3028',
 'seabrook': '3028',
 'hoppers crossing': '3029',
 'tarneit': '3029',
 'truganina': '3029',
 'cocoroc': '3030',
 'derrimut': '3030',
 'point cook': '3030',
 'quandong': '3030',
 'werribee': '3030',
 'werribee south': '3030',
 'flemington': '3031',
 'kensington': '3031',
 'ascot vale': '3032',
 'highpoint city': '3032',
 'maribyrnong': '3032',
 'travancore': '3032',
 'keilor east': '3033',
 'avondale heights': '3034',
 'keilor': '3036',
 'keilor north': '3036',
 'calder park': '3037',
 'delahey': '3037',
 'hillside': '3875',
 'sydenham': '3037',
 'taylors hill': '3037',
 'keilor downs': '3038',
 'keilor lodge': '3038',
 'taylors lakes': '3038',
 'moonee ponds': '3039',
 'aberfeldie': '3040',
 'essendon': '3040',
 'essendon west': '3040',
 'essendon fields': '3041',
 'essendon north': '3041',
 'strathmore': '3041',
 'strathmore heights': '3041',
 'airport west': '3042',
 'keilor park': '3042',
 'niddrie': '3042',
 'gladstone park': '3043',
 'gowanbrae': '3043',
 'tullamarine': '3043',
 'pascoe vale': '3044',
 'pascoe vale south': '3044',
 'melbourne airport': '3045',
 'glenroy': '3046',
 'hadfield': '3046',
 'oak park': '3046',
 'broadmeadows': '3047',
 'dallas': '3047',
 'jacana': '3047',
 'coolaroo': '3048',
 'meadow heights': '3048',
 'attwood': '3049',
 'westmeadows': '3049',
 'royal melbourne hospital': '3050',
 'hotham hill': '3051',
 'north melbourne': '3051',
 'melbourne university': '3052',
 'parkville': '3052',
 'carlton': '3053',
 'carlton south': '3053',
 'carlton north': '3054',
 'princes hill': '3054',
 'brunswick south': '3055',
 'brunswick west': '3055',
 'moonee vale': '3055',
 'moreland west': '3055',
 'brunswick': '3056',
 'brunswick lower': '3056',
 'brunswick north': '3056',
 'brunswick east': '3057',
 'sumner': '3057',
 'batman': '3058',
 'coburg': '3058',
 'coburg north': '3058',
 'merlynston': '3058',
 'moreland': '3058',
 'greenvale': '3059',
 'fawkner': '3060',
 'campbellfield': '3061',
 'somerton': '3062',
 'oaklands junction': '3063',
 'yuroke': '3063',
 'craigieburn': '3064',
 'donnybrook': '3064',
 'kalkallo': '3064',
 'mickleham': '3064',
 'roxburgh park': '3064',
 'fitzroy': '3065',
 'collingwood': '3066',
 'collingwood north': '3066',
 'abbotsford': '3067',
 'clifton hill': '3068',
 'fitzroy north': '3068',
 'northcote': '3070',
 'thornbury': '3071',
 'gilberton': '3072',
 'northland centre': '3072',
 'preston': '3072',
 'preston south': '3072',
 'preston west': '3072',
 'regent west': '3072',
 'reservoir': '3073',
 'thomastown': '3074',
 'lalor': '3075',
 'epping': '3076',
 'alphington': '3078',
 'fairfield': '3078',
 'ivanhoe': '3079',
 'ivanhoe east': '3079',
 'ivanhoe north': '3079',
 'bellfield': '3381',
 'heidelberg heights': '3081',
 'heidelberg west': '3081',
 'mill park': '3082',
 'bundoora': '3083',
 'kingsbury': '3083',
 'la trobe university': '3083',
 'banyule': '3084',
 'eaglemont': '3084',
 'heidelberg': '3084',
 'rosanna': '3084',
 'viewbank': '3084',
 'macleod': '3085',
 'macleod west': '3085',
 'yallambie': '3085',
 'watsonia': '3087',
 'watsonia north': '3087',
 'briar hill': '3088',
 'greensborough': '3088',
 'st helena': '3088',
 'diamond creek': '3089',
 'plenty': '3090',
 'yarrambat': '3091',
 'lower plenty': '3093',
 'montmorency': '3094',
 'eltham': '3095',
 'eltham north': '3095',
 'research': '3095',
 'wattle glen': '3096',
 'bend of islands': '3097',
 'kangaroo ground': '3097',
 'watsons creek': '3097',
 'arthurs creek': '3099',
 'cottles bridge': '3099',
 'hurstbridge': '3099',
 'nutfield': '3099',
 'strathewen': '3099',
 'cotham': '3101',
 'kew': '3101',
 'kew east': '3102',
 'balwyn': '3103',
 'balwyn east': '3103',
 'deepdene': '3103',
 'balwyn north': '3104',
 'greythorn': '3104',
 'bulleen': '3105',
 'templestowe': '3106',
 'templestowe lower': '3107',
 'doncaster': '3108',
 'doncaster east': '3109',
 'doncaster heights': '3109',
 'donvale': '3111',
 'north warrandyte': '3113',
 'warrandyte': '3113',
 'park orchards': '3114',
 'wonga park': '3115',
 'chirnside park': '3116',
 'burnley': '3121',
 'burnley north': '3121',
 'cremorne': '3121',
 'richmond': '3121',
 'richmond east': '3121',
 'richmond north': '3121',
 'richmond south': '3121',
 'auburn south': '3122',
 'glenferrie south': '3122',
 'hawthorn': '3122',
 'hawthorn north': '3122',
 'hawthorn west': '3122',
 'auburn': '3123',
 'hawthorn east': '3123',
 'camberwell': '3124',
 'camberwell north': '3124',
 'camberwell south': '3124',
 'camberwell west': '3124',
 'hartwell': '3124',
 'middle camberwell': '3124',
 'burwood': '3125',
 'camberwell east': '3126',
 'canterbury': '3126',
 'mont albert': '3127',
 'surrey hills': '3127',
 'surrey hills north': '3127',
 'box hill': '3128',
 'box hill south': '3128',
 'wattle park': '3128',
 'box hill north': '3129',
 'kerrimuir': '3129',
 'mont albert north': '3129',
 'blackburn': '3130',
 'blackburn north': '3130',
 'blackburn south': '3130',
 'laburnum': '3130',
 'brentford square': '3131',
 'forest hill': '3131',
 'nunawading': '3131',
 'mitcham': '3132',
 'mitcham north': '3132',
 'rangeview': '3132',
 'vermont': '3133',
 'vermont south': '3133',
 'heathwood': '3134',
 'ringwood': '3134',
 'ringwood north': '3134',
 'warrandyte south': '3134',
 'warranwood': '3134',
 'bedford road': '3135',
 'heathmont': '3135',
 'ringwood east': '3135',
 'croydon': '3136',
 'croydon hills': '3136',
 'croydon north': '3136',
 'croydon south': '3136',
 'kilsyth': '3137',
 'kilsyth south': '3137',
 'mooroolbark': '3138',
 'beenak': '3139',
 'don valley': '3139',
 'hoddles creek': '3139',
 'launching place': '3139',
 'seville': '3139',
 'seville east': '3139',
 'wandin east': '3139',
 'wandin north': '3139',
 'woori yallock': '3139',
 'yellingbo': '3139',
 'lilydale': '3140',
 'south yarra': '3141',
 'hawksburn': '3142',
 'toorak': '3142',
 'armadale': '3143',
 'armadale north': '3143',
 'kooyong': '3144',
 'malvern': '3144',
 'caulfield east': '3145',
 'central park': '3145',
 'darling': '3145',
 'malvern east': '3145',
 'wattletree road po': '3145',
 'glen iris': '3146',
 'ashburton': '3147',
 'ashwood': '3147',
 'chadstone': '3148',
 'chadstone centre': '3148',
 'holmesglen': '3148',
 'mount waverley': '3149',
 'pinewood': '3149',
 'syndal': '3149',
 'brandon park': '3150',
 'glen waverley': '3150',
 'wheelers hill': '3150',
 'burwood east': '3151',
 'burwood heights': '3151',
 'knox city centre': '3152',
 'studfield': '3152',
 'wantirna': '3152',
 'wantirna south': '3152',
 'bayswater': '3153',
 'bayswater north': '3153',
 'the basin': '3154',
 'boronia': '3155',
 'ferntree gully': '3156',
 'lysterfield': '3156',
 'lysterfield south': '3156',
 'mountain gate': '3156',
 'upper ferntree gully': '3156',
 'upwey': '3158',
 'menzies creek': '3159',
 'selby': '3159',
 'belgrave': '3160',
 'belgrave heights': '3160',
 'belgrave south': '3160',
 'tecoma': '3160',
 'caulfield junction': '3161',
 'caulfield north': '3161',
 'caulfield': '3162',
 'caulfield south': '3162',
 'hopetoun gardens': '3162',
 'carnegie': '3163',
 'glen huntly': '3163',
 'murrumbeena': '3163',
 'dandenong south': '3175',
 'bentleigh east': '3165',
 'hughesdale': '3166',
 'huntingdale': '3166',
 'oakleigh': '3166',
 'oakleigh east': '3166',
 'oakleigh south': '3167',
 'clayton': '3168',
 'notting hill': '3168',
 'clarinda': '3169',
 'clayton south': '3169',
 'mulgrave': '3170',
 'waverley gardens': '3170',
 'sandown village': '3171',
 'springvale': '3171',
 'dingley village': '3172',
 'springvale south': '3172',
 'keysborough': '3173',
 'noble park': '3174',
 'noble park north': '3174',
 'bangholme': '3175',
 'dandenong': '3175',
 'dandenong east': '3175',
 'dandenong north': '3175',
 'dunearn': '3175',
 'scoresby bc': '3176',
 'doveton': '3177',
 'eumemmerring': '3177',
 'rowville': '3178',
 'scoresby': '3179',
 'knoxfield': '3180',
 'prahran': '3181',
 'prahran east': '3181',
 'windsor': '3181',
 'st kilda': '3182',
 'st kilda south': '3182',
 'st kilda west': '3182',
 'balaclava': '3183',
 'st kilda east': '3183',
 'brighton road': '3184',
 'elwood': '3184',
 'elsternwick': '3185',
 'gardenvale': '3185',
 'ripponlea': '3185',
 'brighton': '3186',
 'brighton north': '3186',
 'dendy': '3186',
 'were street po': '3186',
 'brighton east': '3187',
 'north road': '3187',
 'hampton': '3188',
 'hampton east': '3188',
 'hampton north': '3188',
 'moorabbin': '3189',
 'moorabbin east': '3189',
 'wishart': '3189',
 'highett': '3190',
 'sandringham': '3191',
 'cheltenham': '3192',
 'cheltenham east': '3192',
 'southland centre': '3192',
 'beaumaris': '3193',
 'black rock': '3193',
 'black rock north': '3193',
 'cromer': '3193',
 'mentone': '3194',
 'mentone east': '3194',
 'moorabbin airport': '3194',
 'aspendale': '3195',
 'aspendale gardens': '3195',
 'braeside': '3195',
 'mordialloc': '3195',
 'parkdale': '3195',
 'waterways': '3195',
 'bonbeach': '3196',
 'chelsea': '3196',
 'chelsea heights': '3196',
 'edithvale': '3196',
 'carrum': '3197',
 'patterson lakes': '3197',
 'seaford': '3198',
 'frankston': '3199',
 'frankston east': '3199',
 'frankston heights': '3199',
 'frankston south': '3199',
 'karingal centre': '3199',
 'frankston north': '3200',
 'pines forest': '3200',
 'carrum downs': '3201',
 'heatherton': '3202',
 'bentleigh': '3204',
 'mckinnon': '3204',
 'ormond': '3204',
 'patterson': '3204',
 'south melbourne': '3205',
 'albert park': '3206',
 'middle park': '3206',
 'garden city': '3207',
 'port melbourne': '3207',
 'little river': '3211',
 'avalon': '3212',
 'lara': '3212',
 'point wilson': '3212',
 'anakie': '3213',
 'batesford': '3213',
 'lovely banks': '3213',
 'moorabool': '3213',
 'corio': '3214',
 'norlane': '3214',
 'north shore': '3214',
 'bell park': '3215',
 'bell post hill': '3215',
 'drumcondra': '3215',
 'geelong north': '3215',
 'hamlyn heights': '3215',
 'north geelong': '3215',
 'rippleside': '3215',
 'belmont': '3216',
 'grovedale': '3216',
 'grovedale east': '3216',
 'highton': '3216',
 'marshall': '3216',
 'wandana heights': '3216',
 'waurn ponds': '3216',
 'armstrong creek': '3217',
 'charlemont': '3217',
 'freshwater creek': '3217',
 'mount duneed': '3217',
 'fyansford': '3218',
 'geelong west': '3218',
 'herne hill': '3218',
 'manifold heights': '3218',
 'murgheboluc': '3218',
 'stonehaven': '3218',
 'breakwater': '3219',
 'east geelong': '3219',
 'newcomb': '3219',
 'st albans park': '3219',
 'thomson': '3825',
 'whittington': '3219',
 'bareena': '3220',
 'geelong': '3220',
 'newtown': '3351',
 'south geelong': '3220',
 'barrabool': '3221',
 'ceres': '3221',
 'gnarwarre': '3221',
 'clifton springs': '3222',
 'curlewis': '3222',
 'drysdale': '3222',
 'mannerim': '3222',
 'marcus hill': '3222',
 'wallington': '3222',
 'bellarine': '3223',
 'indented head': '3223',
 'portarlington': '3223',
 'st leonards': '3223',
 'leopold': '3224',
 'moolap': '3224',
 'point lonsdale': '3225',
 'queenscliff': '3225',
 'swan bay': '3225',
 'swan island': '3225',
 'ocean grove': '3226',
 'barwon heads': '3227',
 'breamlea': '3227',
 'connewarre': '3227',
 'bellbrae': '3228',
 'bells beach': '3228',
 'jan juc': '3228',
 'torquay': '3228',
 'anglesea': '3230',
 'aireys inlet': '3231',
 'big hill': '3555',
 'eastern view': '3231',
 'fairhaven': '3231',
 'moggs creek': '3231',
 'lorne': '3232',
 'apollo bay': '3233',
 'cape otway': '3233',
 'marengo': '3233',
 'petticoat creek': '3233',
 'skenes creek': '3233',
 'skenes creek north': '3233',
 'grey river': '3234',
 'kennett river': '3234',
 'separation creek': '3234',
 'sugarloaf': '3234',
 'wongarra': '3234',
 'wye river': '3234',
 'benwerrin': '3235',
 'boonah': '3235',
 'deans marsh': '3235',
 'pennyroyal': '3235',
 'forrest': '3236',
 'mount sabine': '3236',
 'aire valley': '3237',
 'beech forest': '3237',
 'ferguson': '3237',
 'gellibrand lower': '3237',
 'wattle hill': '3237',
 'weeaproinah': '3237',
 'wyelangta': '3237',
 'yuulong': '3237',
 'glenaire': '3238',
 'hordern vale': '3238',
 'johanna': '3238',
 'lavers hill': '3238',
 'carlisle river': '3239',
 'chapple vale': '3239',
 'gellibrand': '3239',
 'kennedys creek': '3239',
 'buckley': '3240',
 'gherang': '3240',
 'modewarre': '3240',
 'moriac': '3240',
 'mount moriac': '3240',
 'paraparap': '3240',
 'bambra': '3241',
 'ombersley': '3241',
 'wensleydale': '3241',
 'winchelsea': '3241',
 'winchelsea south': '3241',
 'wurdiboluc': '3241',
 'birregurra': '3242',
 'barwon downs': '3243',
 'murroon': '3243',
 'warncoort': '3243',
 'whoorel': '3243',
 'alvie': '3249',
 'balintore': '3249',
 'barongarook': '3249',
 'barongarook west': '3249',
 'barramunga': '3249',
 'coragulac': '3249',
 'corunnun': '3249',
 'dreeite': '3249',
 'dreeite south': '3249',
 'gerangamete': '3249',
 'irrewarra': '3249',
 'irrewillipe': '3249',
 'irrewillipe east': '3249',
 'kawarren': '3249',
 'larpent': '3249',
 'nalangil': '3249',
 'ondit': '3249',
 'pirron yallock': '3249',
 'pomborneit east': '3249',
 'swan marsh': '3249',
 'tanybryn': '3249',
 'warrion': '3249',
 'wool wool': '3249',
 'yeo': '3249',
 'yeodene': '3249',
 'colac': '3250',
 'colac east': '3250',
 'colac west': '3250',
 'elliminyt': '3250',
 'beeac': '3251',
 'cundare': '3251',
 'cundare north': '3251',
 'eurack': '3251',
 'weering': '3251',
 'cororooke': '3254',
 'bookaar': '3260',
 'bostocks creek': '3260',
 'bungador': '3260',
 'camperdown': '3260',
 'carpendeit': '3260',
 'chocolyn': '3260',
 'gnotuk': '3260',
 'kariah': '3260',
 'koallah': '3260',
 'leslie manor': '3260',
 'pomborneit': '3260',
 'pomborneit north': '3260',
 'skibo': '3260',
 'south purrumbete': '3260',
 'stonyford': '3260',
 'tandarook': '3260',
 'tesbury': '3260',
 'weerite': '3260',
 'terang': '3264',
 'boorcan': '3265',
 'cudgee': '3265',
 'dixie': '3265',
 'ecklin south': '3265',
 'ellerslie': '3265',
 'framlingham': '3265',
 'framlingham east': '3265',
 'garvoc': '3265',
 'glenormiston north': '3265',
 'glenormiston south': '3265',
 'kolora': '3265',
 'laang': '3265',
 'noorat': '3265',
 'noorat east': '3265',
 'panmure': '3265',
 'taroon': '3265',
 'the sisters': '3265',
 'bullaharre': '3266',
 'cobden': '3266',
 'cobrico': '3266',
 'elingamite': '3266',
 'elingamite north': '3266',
 'glenfyne': '3266',
 'jancourt': '3266',
 'jancourt east': '3266',
 'naroghid': '3266',
 'simpson': '3266',
 'scotts creek': '3267',
 'ayrford': '3268',
 'brucknell': '3268',
 'cooriemungle': '3268',
 'cowleys creek': '3268',
 'curdies river': '3268',
 'curdievale': '3268',
 'heytesbury lower': '3268',
 'newfield': '3268',
 'nirranda': '3268',
 'nirranda east': '3268',
 'nirranda south': '3268',
 'nullawarre': '3268',
 'nullawarre north': '3268',
 'paaratte': '3268',
 'the cove': '3268',
 'timboon': '3268',
 'timboon west': '3268',
 'port campbell': '3269',
 'princetown': '3269',
 'waarre': '3269',
 'peterborough': '3270',
 'darlington': '3271',
 'dundonnell': '3271',
 'pura pura': '3271',
 'mortlake': '3272',
 'woorndoo': '3272',
 'hexham': '3273',
 'caramut': '3274',
 'mailors flat': '3275',
 'minjah': '3276',
 'woolsthorpe': '3276',
 'allansford': '3277',
 'mepunga': '3277',
 'mepunga east': '3277',
 'mepunga west': '3277',
 'naringal': '3277',
 'naringal east': '3277',
 'purnim': '3278',
 'purnim west': '3278',
 'ballangeich': '3279',
 'wangoom': '3279',
 'dennington': '3280',
 'warrnambool': '3280',
 'bushfield': '3281',
 'grassmere': '3281',
 'winslow': '3281',
 'woodford': '3281',
 'illowa': '3282',
 'koroit': '3282',
 'crossley': '3283',
 'killarney': '3283',
 'kirkstall': '3283',
 'southern cross': '3283',
 'tarrone': '3283',
 'tower hill': '3283',
 'warrong': '3283',
 'willatook': '3283',
 'yangery': '3283',
 'yarpturk': '3283',
 'orford': '3284',
 'port fairy': '3284',
 'codrington': '3285',
 'narrawong': '3285',
 'rosebrook': '3285',
 'st helens': '3285',
 'toolong': '3285',
 'tyrendarra': '3285',
 'tyrendarra east': '3285',
 'yambuk': '3285',
 'condah swamp': '3286',
 'knebsworth': '3286',
 'macarthur': '3286',
 'warrabkook': '3286',
 'hawkesdale': '3287',
 'minhamite': '3287',
 'gazette': '3289',
 'gerrigerrup': '3289',
 'penshurst': '3289',
 'purdeet': '3289',
 'tabor': '3289',
 'nelson': '3292',
 'glenthompson': '3293',
 'nareeb': '3293',
 'narrapumelap south': '3293',
 'dunkeld': '3294',
 'karabeal': '3294',
 'mirranatwa': '3294',
 'moutajup': '3294',
 'victoria point': '3294',
 'victoria valley': '3294',
 'woodhouse': '3294',
 'byaduk north': '3300',
 'hamilton': '3300',
 'bochara': '3301',
 'broadwater': '3301',
 'buckley swamp': '3301',
 'byaduk': '3301',
 'croxton east': '3301',
 'hensley park': '3301',
 'morgiana': '3301',
 'mount napier': '3301',
 'strathkellar': '3301',
 'tahara': '3301',
 'tarrington': '3301',
 'wannon': '3301',
 'warrayure': '3301',
 'yatchaw': '3301',
 'yulecart': '3301',
 'branxholme': '3302',
 'grassdale': '3302',
 'breakaway creek': '3303',
 'condah': '3303',
 'hotspur': '3303',
 'lake condah': '3303',
 'wallacedale': '3303',
 'bessiebelle': '3304',
 'dartmoor': '3304',
 'drik drik': '3304',
 'drumborg': '3304',
 'greenwald': '3304',
 'heywood': '3304',
 'homerton': '3304',
 'lyons': '3304',
 'milltown': '3304',
 'mumbannar': '3304',
 'myamyn': '3304',
 'winnap': '3304',
 'allestree': '3305',
 'bolwarra': '3305',
 'cape bridgewater': '3305',
 'cashmore': '3305',
 'dutton way': '3305',
 'gorae': '3305',
 'gorae west': '3305',
 'heathmere': '3305',
 'mount richmond': '3305',
 'portland': '3305',
 'portland north': '3305',
 'portland west': '3305',
 'digby': '3309',
 'merino': '3310',
 'tahara west': '3310',
 'casterton': '3311',
 'corndale': '3311',
 'bahgallah': '3312',
 'brimboal': '3312',
 'carapook': '3312',
 'chetwynd': '3312',
 'dergholm': '3312',
 'dorodong': '3312',
 'dunrobin': '3312',
 'henty': '3312',
 'killara': '3691',
 'lake mundi': '3312',
 'lindsay': '3312',
 'nangeela': '3312',
 'poolaijelo': '3312',
 'powers creek': '3312',
 'sandford': '3312',
 'strathdownie': '3312',
 'wando bridge': '3312',
 'wando vale': '3312',
 'warrock': '3312',
 'bulart': '3314',
 'cavendish': '3314',
 'glenisla': '3314',
 'grampians': '3314',
 'mooralla': '3314',
 'brit brit': '3315',
 'clover flat': '3315',
 'coleraine': '3315',
 'coojar': '3315',
 'culla': '3315',
 'gringegalgona': '3315',
 'gritjurk': '3315',
 'hilgay': '3315',
 'konongwootong': '3315',
 'melville forest': '3315',
 'muntham': '3315',
 'nareen': '3315',
 'paschendale': '3315',
 'tahara bridge': '3315',
 'tarrayoukyan': '3315',
 'tarrenlea': '3315',
 'wootong vale': '3315',
 'harrow': '3317',
 'charam': '3318',
 'connewirricoo': '3318',
 'edenhope': '3318',
 'kadnook': '3318',
 'langkoop': '3318',
 'patyah': '3318',
 'ullswater': '3318',
 'apsley': '3319',
 'benayeo': '3319',
 'bringalbert': '3319',
 'hesse': '3321',
 'inverleigh': '3321',
 'wingeel': '3321',
 'cressy': '3322',
 'berrybank': '3323',
 'duverney': '3323',
 'foxhow': '3323',
 'lismore': '3324',
 'mingay': '3324',
 'mount bute': '3324',
 'derrinallum': '3325',
 'larralea': '3325',
 'vite vite': '3325',
 'vite vite north': '3325',
 'teesdale': '3328',
 'barunah park': '3329',
 'barunah plains': '3329',
 'shelford': '3329',
 'rokewood': '3330',
 'bannockburn': '3331',
 'gheringhap': '3331',
 'maude': '3331',
 'russells bridge': '3331',
 'she oaks': '3331',
 'steiglitz': '3331',
 'sutherlands creek': '3331',
 'lethbridge': '3332',
 'bamganie': '3333',
 'meredith': '3333',
 'bungal': '3334',
 'cargerie': '3334',
 'elaine': '3334',
 'morrisons': '3334',
 'mount doran': '3334',
 'plumpton': '3335',
 'rockbank': '3335',
 'kurunjang': '3337',
 'melton': '3337',
 'melton west': '3337',
 'toolern vale': '3337',
 'brookfield': '3338',
 'exford': '3338',
 'eynesbury': '3338',
 'melton south': '3338',
 'bacchus marsh': '3340',
 'balliang': '3340',
 'balliang east': '3340',
 'coimadai': '3340',
 'darley': '3340',
 'glenmore': '3340',
 'hopetoun park': '3340',
 'long forest': '3340',
 'maddingley': '3340',
 'merrimu': '3340',
 'parwan': '3340',
 'rowsley': '3340',
 'staughton vale': '3340',
 'dales creek': '3341',
 'greendale': '3341',
 'korobeit': '3341',
 'myrniong': '3341',
 'pentland hills': '3341',
 'ballan': '3342',
 'beremboke': '3342',
 'blakeville': '3342',
 'bunding': '3342',
 'colbrook': '3342',
 'durdidwarrah': '3342',
 'fiskville': '3342',
 'ingliston': '3342',
 'mount wallace': '3342',
 'gordon': '3345',
 'alfredton': '3350',
 'bakery hill': '3354',
 'ballarat': '3353',
 'ballarat central': '3350',
 'ballarat east': '3350',
 'ballarat north': '3350',
 'ballarat west': '3350',
 'black hill': '3350',
 'brown hill': '3350',
 'canadian': '3350',
 'eureka': '3350',
 'golden point': '3465',
 'invermay park': '3350',
 'lake wendouree': '3350',
 'lucas': '3350',
 'mount clear': '3350',
 'mount helen': '3350',
 'mount pleasant': '3350',
 'nerrina': '3350',
 'newington': '3350',
 'redan': '3350',
 'soldiers hill': '3350',
 'berringa': '3351',
 'bo peep': '3351',
 'cape clear': '3351',
 'carngham': '3351',
 'chepstowe': '3351',
 'haddon': '3351',
 'hillcrest': '3351',
 'illabarook': '3351',
 'lake bolac': '3351',
 'mininera': '3351',
 'mount emu': '3351',
 'nerrin nerrin': '3351',
 'nintingbool': '3351',
 'piggoreet': '3351',
 'pitfield': '3351',
 'rokewood junction': '3351',
 'ross creek': '3351',
 'scarsdale': '3351',
 'smythes creek': '3351',
 'smythesdale': '3351',
 'snake valley': '3351',
 'springdallah': '3351',
 'staffordshire reef': '3351',
 'streatham': '3351',
 'wallinduc': '3351',
 'westmere': '3351',
 'addington': '3352',
 'blowhard': '3352',
 'bolwarrah': '3352',
 'bonshaw': '3352',
 'brewster': '3352',
 'bullarook': '3352',
 'bungaree': '3352',
 'bunkers hill': '3352',
 'burrumbeet': '3352',
 'cambrian hill': '3352',
 'cardigan': '3352',
 'cardigan village': '3352',
 'chapel flat': '3352',
 'clarendon': '3352',
 'claretown': '3352',
 'clarkes hill': '3352',
 'corindhap': '3352',
 'dereel': '3352',
 'dunnstown': '3352',
 'durham lead': '3352',
 'enfield': '3352',
 'ercildoune': '3352',
 'garibaldi': '3352',
 'glen park': '3352',
 'glenbrae': '3352',
 'gong gong': '3352',
 'grenville': '3352',
 'invermay': '3352'
}

def extract_suburb_postcode(address):
    '''This function outputs the suburb and postcode based on the address
    
    Parameters:
    address: address string that contains the suburb
    
    Returns:
    suburb and postcode
    '''
    address_lower = address.lower() 
    for suburb, postcode in suburb_postcode_mapping.items():
        if suburb in address_lower:
            return suburb.title(), postcode
    return 'Unknown', 'Unknown'


def categorise_property(row):
    '''
    This function categorizes properties based on the structure of the address.
    
    Parameters:
    row: instance in the dataset
    
    Returns:
    property type
    '''
     # If 'Property Type' is NaN or missing, categorize based on the address
    if pd.isna(row['Property Type']):
        # Extract the first part of the address (number part) using split
        number_part = row['Address'].split(' ')[0]

        # Check if the number part is 'UNIT' or contains any '/' or letters
        if number_part.upper() == 'UNIT' or re.search(r'[/A-Za-z]', number_part):
            return 'Apartment / Unit / Flat'
        else:
            return 'House'
    
    # If the property is already categorized as 'Townhouse', keep it as 'Townhouse'
    if 'Townhouse' in row['Property Type']:
        return 'Townhouse'

    # If not a townhouse, check for unit/apartment or house based on the address
    number_part = row['Address'].split(' ')[0]
    if number_part.upper() == 'UNIT' or re.search(r'[/A-Za-z]', number_part):
        return 'Apartment / Unit / Flat'
    else:
        return 'House'
    
def calculate_annual_increase(row):
    historical_prices = row['Historical Prices']
    
    if pd.isna(historical_prices):
        return pd.Series([None, None, None, None])  # Return None for all outputs if no historical prices
    
    # Use regex to extract date-price pairs like 'August 2023$1,100'
    date_price_pairs = re.findall(r'([A-Za-z]+\s\d{4})\$([\d,]+)(?:\s*-\s*\$[\d,]*)?', historical_prices)
    
    # Convert extracted data to usable format
    if not date_price_pairs:
        return pd.Series([None, None, None, None])
    
    # Parse the dates and prices
    dates_prices = [(parser.parse(date), float(price.replace(',', ''))) for date, price in date_price_pairs]
    
    # Sort by date
    dates_prices.sort(key=lambda x: x[0])
    
    # Extract oldest and newest prices
    oldest_date, oldest_price = dates_prices[0]
    newest_date, newest_price = dates_prices[-1]
    
    # Calculate the number of months between the oldest and newest dates
    months_diff = (newest_date.year - oldest_date.year) * 12 + (newest_date.month - oldest_date.month)
    
    # Calculate the annual increase percentage
    if months_diff == 0:
        annual_increase_pct = None  # Avoid division by zero if the dates are the same
    else:
        annual_increase_pct = ((newest_price - oldest_price) / oldest_price) * (12 / months_diff) * 100
    
    return pd.Series([oldest_price, oldest_date, newest_price, newest_date, months_diff, annual_increase_pct])

def extract_number(value):
    ''''This function extracts the number from a string
    
    Parameters:
    value: instance from a feature that contains the feature and number eg '1 Bed
    
    Returns:
    numbers: just the number from the instance'''
    if pd.isna(value):
        return None  # Keep NaN as is
    # Use regex to find all numeric characters and join them into a single number
    numbers = re.findall(r'\d+', str(value))
    return int(numbers[0]) if numbers else None

def extract_first_number(cost):
    '''This function find the rental price from a string
    
    Parameters:
    cost: string with rental price inside
    
    Returns:
    math: just the rental price'''
    if pd.isna(cost):
        return None  # Keep NaN as is
    # Use regex to find the first occurrence of a number (with optional decimal)
    match = re.search(r'\d+[\.,]?\d*', str(cost))
    if match:
        # Return the matched number as a float after removing any commas
        return float(match.group(0).replace(',', ''))
    return None